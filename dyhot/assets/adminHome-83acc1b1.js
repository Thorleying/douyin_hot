import{g as x}from"./getHomeData-12411199.js";import{d as F,a as I}from"./operate-7044ec2f.js";import{B as C,y as D,l as E,r as M,t as S,m as A,_ as N,a as i,o as c,g as w,d as n,b as d,w as m,K as O,i as U,c as v,F as j,C as H,p as R,f as V}from"./index-4944d5d0.js";import{a as q}from"./request-571d1387.js";import{g as L}from"./time-b2b908c3.js";import{U as K}from"./UploadOutlined-41e85968.js";const T={name:"adminHome",components:{UploadOutlined:K},setup(){const t=C();let o=D(!1);const b=[{title:"序号",width:50,dataIndex:"Id",key:"name",fixed:"left"},{title:"二维码",dataIndex:"img",key:"img",width:80},{title:"名称",dataIndex:"name",key:"name",width:80},{title:"链接",dataIndex:"href",key:"href",width:150},{title:"上传时间",dataIndex:"time",key:"time",width:200},{title:"操作",key:"operation",fixed:"right",width:180}],l=E();let s=M({tableLists:[],loading:!0,img:"",name:"",href:""});const r=async()=>{const{data:a}=await x();s.tableLists=a,s.loading=!1},f=async a=>{if(confirm("是否删除这个内容")){const{data:e}=await F(a);console.log(e),e===1&&(alert("删除成功"),await r())}else alert("取消成功")};r();const _=a=>{l.push({name:"edit-obj",query:{editDataId:a.Id}})},h=()=>{console.log("打开弹窗"),o.value=!0,console.log("更改弹窗状态",t.state.openModelState)},g=()=>{o.value=!0},y=async()=>{const a={name:s.name,href:s.href,img:s.img,time:L()};console.log(a);const{data:e}=await I(a);console.log(e,"输出状态"),e===1&&A.success("添加成功"),await r(),o.value=!1},p=a=>{let e=new FormData;e.append("file",a.file),q({url:"https://thorleying.work/bbq/uploadImg.php",method:"post",data:e}).then(async u=>{console.log(u.data),s.img="https://thorleying.work/bbq/upload/"+a.file.name})};return{...S(s),getTableData:r,del:f,edit:_,columns:b,openModelState:h,visible:o,showModal:g,hideModal:y,confirm,afterRead:p}}};const k=t=>(R("data-v-930e5faf"),t=t(),V(),t),z=k(()=>n("h1",null,"管理员主页",-1)),G=["onClick"],J=["onClick"],P=["href"],Q=k(()=>n("a",{style:{"margin-left":"10px"}},"点击预览",-1)),W=[Q],X=["src"],Y={style:{"text-align":"center"}},Z=["src"],$=k(()=>n("br",null,null,-1));function ee(t,o,b,l,s,r){const f=i("upload-outlined"),_=i("a-button"),h=i("a-table"),g=i("a-spin"),y=i("van-uploader"),p=i("a-input"),a=i("a-modal");return c(),w(O,null,[n("div",null,[z,d(_,{type:"primary",onClick:l.openModelState},{icon:m(()=>[d(f)]),default:m(()=>[U(" 点击上传项目 ")]),_:1},8,["onClick"]),d(g,{spinning:t.loading},{default:m(()=>[d(h,{columns:l.columns,"data-source":t.tableLists,scroll:{x:1400,y:400}},{bodyCell:m(({column:e,record:u})=>[e.key==="operation"?(c(),v(j,{key:0},[n("a",{onClick:B=>l.edit(u)},"点击编辑",8,G),n("a",{style:{"padding-left":"10px"},onClick:B=>l.del(u.Id)},"点击删除",8,J),n("a",{href:u.href,target:"_blank"},W,8,P)],64)):e.key==="img"?(c(),v("img",{key:1,src:u.img,style:{width:"80px"}},null,8,X)):H("",!0)]),_:1},8,["columns","data-source"])]),_:1},8,["spinning"]),n("div",null,[d(a,{visible:l.visible,"onUpdate:visible":o[2]||(o[2]=e=>l.visible=e),title:"Modal","ok-text":"确认","cancel-text":"取消",onOk:l.hideModal},{default:m(()=>[n("p",Y,[t.img?(c(),v("img",{key:1,src:t.img,alt:"",style:{width:"150px",height:"150px"}},null,8,Z)):(c(),w(y,{key:0,"after-read":l.afterRead},null,8,["after-read"])),$]),n("p",null,[d(p,{placeholder:"请输入标题",value:t.name,"onUpdate:value":o[0]||(o[0]=e=>t.name=e)},null,8,["value"])]),n("p",null,[d(p,{placeholder:"请输入链接",value:t.href,"onUpdate:value":o[1]||(o[1]=e=>t.href=e)},null,8,["value"])])]),_:1},8,["visible","onOk"])])])],1024)}const ie=N(T,[["render",ee],["__scopeId","data-v-930e5faf"]]);export{ie as default};
